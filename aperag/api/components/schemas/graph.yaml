graphNode:
  type: object
  description: Knowledge graph node representing an entity
  properties:
    id:
      type: string
      description: Unique identifier for the node (entity name)
      example: "墨香居"
    labels:
      type: array
      items:
        type: string
      description: Labels associated with the node
      example: ["墨香居"]
    properties:
      type: object
      description: Node properties containing entity metadata
      properties:
        entity_id:
          type: string
          description: Entity identifier
          example: "墨香居"
        entity_type:
          type: string
          description: Type of the entity
          example: "organization"
        description:
          type: string
          description: Description of the entity
          example: "墨香居是这条老巷子里唯一的旧书店，经营着各种书籍，承载了老板李明华的情怀。"
        source_id:
          type: string
          description: Source chunk ID where entity was extracted
          example: "chunk-88845945407136e9498f5f594c8a00c6"
        file_path:
          type: string
          description: Source file path
          example: "story.txt"
        created_at:
          type: integer
          format: int64
          description: Creation timestamp
          example: 1751356233
      additionalProperties: true
  required:
    - id
    - labels
    - properties

graphEdge:
  type: object
  description: Knowledge graph edge representing a relationship
  properties:
    id:
      type: string
      description: Unique identifier for the edge
      example: "墨香居-深夜读书会"
    type:
      type: string
      description: Type of the relationship
      example: "DIRECTED"
      default: "DIRECTED"
    source:
      type: string
      description: Source node ID
      example: "墨香居"
    target:
      type: string
      description: Target node ID
      example: "深夜读书会"
    properties:
      type: object
      description: Edge properties containing relationship metadata
      properties:
        weight:
          type: number
          format: float
          description: Relationship weight/strength
          example: 9.0
        description:
          type: string
          description: Description of the relationship
          example: "深夜读书会是墨香居的新活动，旨在提升书店的活力和吸引顾客。"
        keywords:
          type: string
          description: Keywords associated with the relationship
          example: "书店活力,活动"
        source_id:
          type: string
          description: Source chunk ID where relationship was extracted
          example: "chunk-88845945407136e9498f5f594c8a00c6"
        file_path:
          type: string
          description: Source file path
          example: "story.txt"
        created_at:
          type: integer
          format: int64
          description: Creation timestamp
          example: 1751356233
      additionalProperties: true
  required:
    - id
    - source
    - target
    - properties

knowledgeGraph:
  type: object
  description: Knowledge graph containing nodes and edges
  properties:
    nodes:
      type: array
      items:
        $ref: '#/graphNode'
      description: List of nodes in the knowledge graph
    edges:
      type: array
      items:
        $ref: '#/graphEdge'
      description: List of edges in the knowledge graph
    is_truncated:
      type: boolean
      description: Whether the graph was truncated due to size limits
      example: false
      default: false
  required:
    - nodes
    - edges
    - is_truncated

graphLabelsResponse:
  type: object
  description: Response containing available graph labels
  properties:
    labels:
      type: array
      items:
        type: string
      description: List of available node labels in the knowledge graph
      example: ["墨香居", "李明华", "林晓雯", "深夜读书会"]
  required:
    - labels 

nodeMergeRequest:
  type: object
  description: Request to merge multiple graph nodes
  properties:
    entity_ids:
      type: array
      items:
        type: string
      description: List of entity IDs to merge (supports 1 or more entities)
      example: ["墨香居", "书店", "旧书店"]
      minItems: 1
    target_entity_data:
      type: object
      description: Optional target entity configuration. If not specified or empty, auto-select entity with highest degree
      properties:
        entity_name:
          type: string
          description: Target entity name. If not specified, auto-select entity with highest degree
          example: "墨香居"
        entity_type:
          type: string
          description: Entity type for the target entity
          example: "ORGANIZATION"
        description:
          type: string
          description: Description for the target entity
          example: "A comprehensive bookstore and cultural space"
        source_id:
          type: string
          description: Source ID for the target entity
        file_path:
          type: string
          description: File path for the target entity
      nullable: true
  required:
    - entity_ids
  additionalProperties: false

nodeMergeResponse:
  type: object
  description: Response containing node merge results
  properties:
    status:
      type: string
      description: Status of the merge operation
      example: "success"
      enum: ["success", "error"]
    message:
      type: string
      description: Detailed message about the merge operation
      example: "Successfully merged 2 entities into 墨香居"
    target_entity_data:
      type: object
      description: Complete data of the target entity after merge
      properties:
        entity_name:
          type: string
          description: The entity name that was kept (merge target)
          example: "墨香居"
        entity_type:
          type: string
          description: Entity type of the target entity
          example: "ORGANIZATION"
        description:
          type: string
          description: Merged description of the target entity
          example: "墨香居是这条老巷子里唯一的旧书店，经营着各种书籍，承载了老板李明华的情怀。"
        source_id:
          type: string
          description: Source ID information
          example: "chunk-001,chunk-002"
        file_path:
          type: string
          description: File path information
          example: "story.txt,book.txt"
      required:
        - entity_name
        - entity_type
        - description
      nullable: true
    source_entities:
      type: array
      items:
        type: string
      description: List of entities that were merged into the target
      example: ["书店", "旧书店"]
    redirected_edges:
      type: integer
      description: Number of edges that were redirected during merge
      example: 12
      minimum: 0
    merged_description_length:
      type: integer
      description: Length of the merged description
      example: 512
      minimum: 0
    used_llm_summary:
      type: boolean
      description: Whether LLM was used to summarize descriptions
      example: true
    collection_id:
      type: string
      description: Collection ID where the merge was performed
      example: "col_12345"
      nullable: true
  required:
    - status
    - message
    - target_entity_data
    - source_entities
    - redirected_edges
    - merged_description_length
    - used_llm_summary